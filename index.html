<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>~/startpage</title>
    <link rel="stylesheet" type="text/css" href="style.css">
</head>

<body>
    <div class="container">
        <div class="left-container">
            <div class="gif">
                <img src="cat.gif" />
            </div>
        </div>

        <div class="right-container">
            <div class="head">
                <p class="command-line">> cd ~/ <span class="blinking" id="command">_</span><input type="text" id="commandInput" class="hidden" /></p>
            </div>

            <div class="bookmarks">
                <div class="category" id="category1">
                    <div class="links">
                        <li class="title">Productivity</li>
                        <li><a id="link4" href="https://chatgpt.com/">ChatGPT</a></li>
                        <li><a id="link1" href="https://gmail.com">Gmail</a></li>
                        <li><a id="link2" href="https://linkedin.com">Linkedin</a></li>
                        <li><a id="link3" href="https://www.notion.so/e6df69e26b494eeabef43bbbe6c164bc?v=b8c580e65f854daab22bf0ced353ab40">Notion</a></li>
                    </div>
                </div>

                <div class="category" id="category3">
                    <div class="links">
                        <li class="title">Social</li>
                        <li><a id="link10" href="https://www.facebook.com/messages/t/8672198099569753/">Messenger</a></li>
                        <li><a id="link9" href="https://www.facebook.com/">Facebook</a></li>
                        <li><a id="link11" href="https://www.instagram.com/">Instagram</a></li>
                        <li><a id="link12" href="https://www.reddit.com/">Reddit</a></li>
                    </div>
                </div>

                <div class="category" id="category2">
                    <div class="links">
                        <li class="title">Dev</li>
                        <li><a id="link5" href="https://github.com/">Github</a></li>
                        <li><a id="link6" href="https://gitlab.manodebesis.lt/">Gitlab</a></li>
                        <li><a id="link7" href="https://nuolaidauk.manodebesis.lt/">Nuolaidauk Stage</a></li>
                        <li><a id="link8" href="https://nuolaidauk.lt/">Nuolaidauk Prod</a></li>
                    </div>
                </div>

                <div class="category" id="category4">
                    <div class="links">
                        <li class="title">Media</li>
                        <li><a id="link14" href="https://youtube.com/">Youtube</a></li>
                        <li><a id="link13" href="http://localhost:32400/web/index.html#!/">Plex</a></li>
                        <li><a id="link15" href="https://twitch.tv/">Twitch</a></li>
                        <li><a id="link16" href="https://netflix.com/">Netflix</a></li>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', (event) => {
            let currentCategoryIndex = -1;
            let currentLinkIndex = -1;
            const categories = document.querySelectorAll('.category');
            const commandElement = document.getElementById('command');
            const commandInput = document.getElementById('commandInput');
            let commandText = '';
            let inputMode = false;

            function updateHighlight() {
                document.querySelectorAll('.links a').forEach(link => link.classList.remove('highlight'));
                if (currentCategoryIndex >= 0 && currentLinkIndex >= 0) {
                    const currentLinks = categories[currentCategoryIndex].querySelectorAll('.links a');
                    currentLinkIndex = Math.min(currentLinkIndex, currentLinks.length - 1);
                    currentLinks[currentLinkIndex].classList.add('highlight');
                }
            }

            function levenshtein(a, b) {
                const matrix = [];

                for (let i = 0; i <= b.length; i++) {
                    matrix[i] = [i];
                }

                for (let j = 0; j <= a.length; j++) {
                    matrix[0][j] = j;
                }

                for (let i = 1; i <= b.length; i++) {
                    for (let j = 1; j <= a.length; j++) {
                        if (b.charAt(i - 1) === a.charAt(j - 1)) {
                            matrix[i][j] = matrix[i - 1][j - 1];
                        } else {
                            matrix[i][j] = Math.min(
                                matrix[i - 1][j - 1] + 1,
                                Math.min(matrix[i][j - 1] + 1, matrix[i - 1][j] + 1)
                            );
                        }
                    }
                }

                return matrix[b.length][a.length];
            }

            function openLinkByName(name) {
                const links = document.querySelectorAll('.links a');
                let closestLink = null;
                let closestDistance = Infinity;

                for (let link of links) {
                    const distance = levenshtein(link.textContent.toLowerCase(), name.toLowerCase());
                    if (distance < closestDistance) {
                        closestDistance = distance;
                        closestLink = link;
                    }
                }

                if (closestLink && closestDistance <= 2) { // Allow up to 2 typos
                    closestLink.click();
                } else {
                    alert('No link found with the name: ' + name);
                }
            }

            document.addEventListener('keydown', (event) => {
                if (!inputMode && event.key === 'i') {
                    event.preventDefault();
                    inputMode = true;
                    commandElement.classList.add('hidden');
                    commandInput.classList.remove('hidden');
                    commandInput.focus();
                } else if (!inputMode) {
                    switch (event.key) {
                        case 'j':
                            event.preventDefault();
                            if (currentCategoryIndex === -1) {
                                currentCategoryIndex = 0;
                                currentLinkIndex = 0;
                            } else {
                                const currentLinks = categories[currentCategoryIndex].querySelectorAll('.links a');
                                currentLinkIndex = (currentLinkIndex + 1) % currentLinks.length;
                            }
                            updateHighlight();
                            break;
                        case 'k':
                            event.preventDefault();
                            if (currentCategoryIndex === -1) {
                                currentCategoryIndex = 0;
                                currentLinkIndex = categories[currentCategoryIndex].querySelectorAll('.links a').length - 1;
                            } else {
                                const currentLinks = categories[currentCategoryIndex].querySelectorAll('.links a');
                                currentLinkIndex = (currentLinkIndex - 1 + currentLinks.length) % currentLinks.length;
                            }
                            updateHighlight();
                            break;
                        case 'h':
                            event.preventDefault();
                            if (currentCategoryIndex === -1) {
                                currentCategoryIndex = categories.length - 1;
                                currentLinkIndex = 0;
                            } else {
                                const previousCategoryIndex = (currentCategoryIndex - 1 + categories.length) % categories.length;
                                const previousLinks = categories[previousCategoryIndex].querySelectorAll('.links a');
                                currentLinkIndex = Math.min(currentLinkIndex, previousLinks.length - 1);
                                currentCategoryIndex = previousCategoryIndex;
                            }
                            updateHighlight();
                            break;
                        case 'l':
                            event.preventDefault();
                            if (currentCategoryIndex === -1) {
                                currentCategoryIndex = 1;
                                currentLinkIndex = 0;
                            } else {
                                const nextCategoryIndex = (currentCategoryIndex + 1) % categories.length;
                                const nextLinks = categories[nextCategoryIndex].querySelectorAll('.links a');
                                currentLinkIndex = Math.min(currentLinkIndex, nextLinks.length - 1);
                                currentCategoryIndex = nextCategoryIndex;
                            }
                            updateHighlight();
                            break;
                    }
                } else {
                    switch (event.key) {
                        case 'Enter':
                            event.preventDefault();
                            if (commandInput.value) {
                                openLinkByName(commandInput.value);
                            }
                            break;
                        case 'Escape':
                            event.preventDefault();
                            inputMode = false;
                            commandInput.classList.add('hidden');
                            commandElement.classList.remove('hidden');
                            commandInput.value = ''; // Clear the input box
                            commandText = '';
                            commandElement.textContent = commandText + '_';
                            break;
                    }
                }
            });

            // Add blur event listener to clear the input box when it loses focus
            commandInput.addEventListener('blur', () => {
                commandInput.value = ''; // Clear the input box
                inputMode = false;
                commandInput.classList.add('hidden');
                commandElement.classList.remove('hidden');
                commandText = '';
                commandElement.textContent = commandText + '_';
            });

            updateHighlight();
        });
    </script>
</body>

</html>
